{
  "id": 17344050,
  "org_id": 1300825116,
  "type": "query alert",
  "name": "Disk usage is high for host {{host.name}} on device {{device.name}}",
  "message": "## \ud83d\udea8 What\u2019s happening\n\nLow disk capacity detected on host {{host.name}}.\n\nThis alert indicates that one or more filesystems are **over 90% full**, meaning they are at risk of running out of space for applications to write. If unaddressed, writes will fail and applications may crash. Investigate and free space by deleting or archiving data, or by expanding the volume.\n\n---\n\n## \ud83d\udcc8 Impact\n\nWhen disks run out of space, it can result in:\n\n- Applications failing on writes (such as databases, services writing logs, or temp files)\n- Stuck or crashing jobs (logging, backups, compactions, builds)\n- Node instability (for example, kubelet/daemon issues or package updates failing)\n\nSpace exhaustion can quickly degrade services, especially on hosts that handle large volumes of data or critical workloads.\n\n---\n\n## \ud83d\udee0 How to fix (Runbook)\n\n### \ud83d\udd0d Initial troubleshooting\n\n1. Identify the affected host and device/mount point from the alert.\n2. Open [**Infrastructure \u2192 Host Details**](/infrastructure) for **{{host.name}}**.\n3. In the **Metrics** tab, review:\n   - `system.disk.in_use` (fraction of space used)\n   - `system.disk.total`, `system.disk.used`, `system.disk.free`\n4. SSH into the host to find large directories/files (Linux/macOS):\n   ```bash\n   # Top space consumers by directory (human-readable)\n   sudo du -xhd1 / | sort -h | tail -n 20\n\n   # Top 50 largest files (avoid virtual filesystems)\n   sudo find / -xdev -type f -printf '%s %p\n' 2>/dev/null | sort -nr | head -50\n\n   # Filesystem usage\n   df -h\n   ```\n\n   On systems with `ncdu`:\n\n   ```bash\n   sudo ncdu -x /\n   ```\n\n   For Docker-heavy hosts:\n\n   ```bash\n   docker system df\n   docker ps --filter status=exited --format '{{.ID}}\t{{.Names}}'\n   ```\n\n> \u26a0\ufe0f Be cautious with deletions. Prefer archiving/moving off-host or rotating/truncating logs using the owning service.\n\n### \ud83e\uddf9 Common causes & resolutions\n\nCause | How to resolve safely\n------|------\nRunaway logs (app, systemd/journal) | Rotate/compress logs; fix log levels. For journald: `journalctl --disk-usage`, then set retention (`/etc/systemd/journald.conf`). For example, `SystemMaxUse=1G`, and `sudo systemctl restart systemd-journald`.\nLeftover build/artifact/temp files | Clean workspace caches and temp dirs (`/tmp`, build caches). Add periodic cleanup to CI or cron.\nOld backups/snapshots on the host | Move backups to object storage; prune old sets per retention policy; avoid storing backups on root volumes.\nContainer images/volumes piling up | Remove unused images/containers/volumes once verified: `docker image prune -a`, `docker container prune`, `docker volume ls` (review before removing).\nApplication data growth (DBs, queues) | Purge/archive old data; enable partitioning/TTL; move cold data to cheaper storage; consider resizing the volume.\nLarge core dumps or crash artifacts | Review & archive off-host; tune core dump settings to limit or disable where appropriate.\n\n\n### \ud83d\udd17 Related links\n\n* [Host Map](/infrastructure/map)\n* [Live Processes](/process?query=host%3A{{host.name}})\n* [System Dashboards](/dashboard/lists)\n* [Monitor Documentation](https://docs.datadoghq.com/monitors/)\n\n### \ud83d\udc65 Who should be notified?\n\nAssign the appropriate notification handle for this alert (for example, `@slack-infra`, `@pagerduty-core-systems`):  \n`@your-team-handle`",
  "tags": [
    "integration:host",
    "monitor_pack:host"
  ],
  "query": "max(next_3d):forecast((1 - avg:system.disk.free{*} by {host,device} / avg:system.disk.total{*} by {host,device}) * 100, \"seasonal\", 1, interval=\"60m\", seasonality=\"weekly\") >= 99",
  "options": {
    "thresholds": {
      "critical": 99.0,
      "critical_recovery": 89.0
    },
    "notify_audit": false,
    "include_tags": false,
    "notify_no_data": false,
    "new_host_delay": 300,
    "silenced": {}
  },
  "multi": true,
  "created_at": 1767059422000,
  "created": "2025-12-30T01:50:22.101928+00:00",
  "modified": "2025-12-30T01:50:22.101928+00:00",
  "deleted": null,
  "priority": null,
  "restricted_roles": null,
  "draft_status": "published",
  "assets": [],
  "overall_state_modified": "2025-12-30T01:50:26+00:00",
  "overall_state": "OK",
  "creator": {
    "name": "Datadog Support",
    "email": "support-user-prod@datadoghq.com",
    "handle": "support-na-4xvziqpjcmtl",
    "id": 9109113
  }
}